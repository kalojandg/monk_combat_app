<!DOCTYPE html>
<html lang="bg">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Monk Combat App</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="manifest" href="manifest.json">
</head>

<body>
  <div id="app">
    <!-- Header -->
    <div class="header">
      <div class="header-left">
        <h1>Monk Combat App</h1>
      </div>
      <div class="spacer"></div>
      <div id="lifeStatus" class="status-emoji">ðŸ™‚</div>
      <div class="header-right">
        <button id="btnShortRest">Short Rest</button>
        <button id="btnLongRest" class="primary">Long Rest</button>
        <button id="btnExport">Export</button>
        <input type="file" id="importFile" accept="application/json,.json" style="display:none">
        <button id="btnImport">Import</button>
        <!-- <button id="btnCloudLink">Link Cloud</button>
        <button id="btnCloudPull">Pull</button>
        <span id="cloudDot" class="dot" title="Not linked"></span>
        <small id="cloudStatus">Cloud: not linked</small> -->
      </div>
    </div>

    <!-- Combat Section (Always Visible - Not a Tab) -->
    <div id="tab-combat" class="combat-section">
      <div class="pillbar">
        <div class="pill">HP&nbsp;<span class="big" id="hpCurrentSpan">8</span>/<span class="big" id="hpMaxSpan">10</span></div>
        <div class="pill">Ki&nbsp;<span class="big" id="kiCurrentSpan">1</span>/<span class="big" id="kiMaxSpan2">1</span></div>
        <div class="pill">AC&nbsp;<span class="big" id="acSpan">10</span></div>
        <div class="pill">Prof&nbsp;<span class="big" id="profSpan">+2</span></div>
      </div>

      <div class="pillbar">
        <div class="pill">Melee Atk&nbsp;<span class="big" id="meleeAtkSpan">+2</span></div>
        <div class="pill">Ranged Atk&nbsp;<span class="big" id="rangedAtkSpan">+2</span></div>
      </div>

      <div class="controls">
        <label>HP Î” <input id="hpDelta" type="number" step="1" value="1" class="small"></label>
        <button id="btnDamage" class="danger">Take damage</button>
        <button id="btnHeal" class="success">Heal</button>
        <button id="btnHitAtZero">Hit at 0 â‡’ DS fail</button>
        <button id="btnHealFromZero" class="success">Heal from 0</button>
      </div>

      <div class="controls mt-8">
        <label>Ki Î” <input id="kiDelta" type="number" step="1" value="1" class="small"></label>
        <button id="btnSpendKi">Spend Ki</button>
        <button id="btnGainKi" class="success">Gain Ki</button>
      </div>

      <div class="controls mt-8">
        <button id="btnDsPlus" class="success">Death Save +</button>
        <button id="btnDsMinus" class="danger">Death Save â€“</button>
        <button id="btnCrit" class="success">Crit Success</button>
        <button id="btnCritFail" class="danger">Crit Fail (+2)</button>
        <button id="btnStabilize">Stabilize</button>
      </div>

    </div>

    <div id="deathSavesUI" class="ds-wrap">
      <div class="ds-row">
        <span class="ds-label">Success</span>
        <span class="ds-dot" id="dsS1"></span>
        <span class="ds-dot" id="dsS2"></span>
        <span class="ds-dot" id="dsS3"></span>
      </div>
      <div class="ds-row">
        <span class="ds-label">Fail</span>
        <span class="ds-dot fail" id="dsF1"></span>
        <span class="ds-dot fail" id="dsF2"></span>
        <span class="ds-dot fail" id="dsF3"></span>
      </div>
    </div>

    <!-- ÐžÐ²ÐµÑ€Ð»ÐµÐ¹ Ð¿Ñ€Ð¸ ÑÐ¼ÑŠÑ€Ñ‚ -->
    <div id="youDiedOverlay" class="you-died hidden">
      <div class="you-died-card">
        <div class="you-died-title">YOU DIED</div>
        <button id="btnResurrect" class="success">Resurrect (1 HP)</button>
      </div>
    </div>

    <!-- Tab Navigation -->
    <div class="tab-nav">
      <button class="tab-btn" data-tab="stats">Stats</button>
      <button class="tab-btn" data-tab="pcchar">PC Characteristics</button>
      <button class="tab-btn" data-tab="inventory">Inventory</button>
      <button class="tab-btn" data-tab="shenanigans">Shenanigans</button>
      <button class="tab-btn" data-tab="liners">One-Liners</button>
      <button class="tab-btn" data-tab="excuses">Excuses</button>
      <button class="tab-btn" data-tab="familiars">Familiars</button>
      <button class="tab-btn" data-tab="skills">Skills</button>
      <button class="tab-btn" data-tab="sessionNotes">Session Notes</button>
    </div>

    <!-- Stats tab -->
    <div id="tab-stats" class="tab hidden">
      <div class="section-title">Basics</div>
      <div class="row-grid">
        <div class="field"><label>Ð˜Ð¼Ðµ</label><input id="charName" type="text" placeholder="ÐŸÐ¸Ð¹Ñ ÐžÑˆÐ¸Ñ‚"></div>
      </div>

      <!-- Row 1 -->
      <div class="row-grid">
        <div class="field"><label>XP</label><input id="xpInput" type="number" step="1"></div>
        <div class="field"><label>Level</label><span class="value-pill" id="levelSpan">1</span></div>
        <div class="field"><label>Proficiency</label><span class="value-pill" id="profSpan2">+2</span></div>
        <div class="field"><label>Martial Arts Die</label><span class="value-pill" id="maDieSpan">d4</span></div>
      </div>

      <!-- Row 2 -->
      <div class="row-grid">
        <div class="field"><label>Max HP</label><span class="value-pill" id="maxHpSpan">10</span></div>
        <div class="field"><label>Homebrew HP</label><input type="number" id="homebrewHp" value="0"></div>
        <div class="field"><label>Max Hit Dice</label><span class="value-pill" id="hdMaxSpan">1</span></div>
        <div class="field"><label>Available Hit Dice</label><span class="value-pill" id="hdAvailSpan">1</span></div>
      </div>

      <!-- Row 3 -->
      <div class="row-grid">
        <div class="field"><label>Max Ki</label><span class="value-pill" id="kiMaxSpan">1</span></div>
        <div class="field"><label>AC (Unarmored)</label><span class="value-pill" id="acSpan2">10</span></div>
        <div class="field"><label>Magic Item Bonus (AC)</label><input id="acMagicInput" type="number" step="1"></div>
      </div>

      <!-- Row 4 -->
      <div class="row-grid">
        <div class="field">
          <label>Melee Magic item Atk Bonus</label>
          <input id="meleeMagicInput" type="number" step="1" value="0">
        </div>
        <div class="field">
          <label>Ranged Magic item Atk Bonus</label>
          <input id="rangedMagicInput" type="number" step="1" value="0">
        </div>
      </div>

      <!-- Row 5 -->
      <div class="row-grid">
        <div class="field"><label>Unarmored Movement (+ft)</label><span class="value-pill" id="umBonusSpan">0</span>
        </div>
        <div class="field"><label>Passive Perception</label><span class="value-pill" id="passPercSpan">10</span></div>
        <div class="field"><label>Passive Investigation</label><span class="value-pill" id="passInvSpan">10</span></div>
        <div class="field"><label>Passive Insight</label><span class="value-pill" id="passInsSpan">10</span></div>
      </div>

      <!-- All saves bonus -->
      <div class="row-grid">
        <div class="field" style="max-width:240px"><label>All Saves Bonus</label><input id="saveAllBonusInput"
            type="number" step="1" value="0"></div>
      </div>

      <!-- Abilities -->
      <div class="section-title">Abilities & Saves</div>
      <div class="abilities-grid">
        <!-- STR -->
        <div class="abil">
          <div class="top"><strong>STR</strong><span class="spacer"></span><label class="small-note"><input
                type="checkbox" id="saveStrProf"> Prof</label></div>
          <div class="bottom">
            <input id="strInput" type="number" step="1" class="small">
            <span class="value-pill mod" id="strModSpan">+0</span>
            <span class="value-pill save" id="saveStrTotalSpan">+0</span>
          </div>
        </div>
        <!-- DEX -->
        <div class="abil">
          <div class="top"><strong>DEX</strong><span class="spacer"></span><label class="small-note"><input
                type="checkbox" id="saveDexProf"> Prof</label></div>
          <div class="bottom">
            <input id="dexInput" type="number" step="1" class="small">
            <span class="value-pill mod" id="dexModSpan">+0</span>
            <span class="value-pill save" id="saveDexTotalSpan">+0</span>
          </div>
        </div>
        <!-- CON -->
        <div class="abil">
          <div class="top"><strong>CON</strong><span class="spacer"></span><label class="small-note"><input
                type="checkbox" id="saveConProf"> Prof</label><label class="small-note" style="margin-left:10px"><input
                type="checkbox" id="toughChk"> Tough</label></div>
          <div class="bottom">
            <input id="conInput" type="number" step="1" class="small">
            <span class="value-pill mod" id="conModSpan">+0</span>
            <span class="value-pill save" id="saveConTotalSpan">+0</span>
          </div>
        </div>
        <!-- INT -->
        <div class="abil">
          <div class="top"><strong>INT</strong><span class="spacer"></span><label class="small-note"><input
                type="checkbox" id="saveIntProf"> Prof</label></div>
          <div class="bottom">
            <input id="intInput" type="number" step="1" class="small">
            <span class="value-pill mod" id="intModSpan">+0</span>
            <span class="value-pill save" id="saveIntTotalSpan">+0</span>
          </div>
        </div>
        <!-- WIS -->
        <div class="abil">
          <div class="top"><strong>WIS</strong><span class="spacer"></span><label class="small-note"><input
                type="checkbox" id="saveWisProf"> Prof</label></div>
          <div class="bottom">
            <input id="wisInput" type="number" step="1" class="small">
            <span class="value-pill mod" id="wisModSpan">+0</span>
            <span class="value-pill save" id="saveWisTotalSpan">+0</span>
          </div>
        </div>
        <!-- CHA -->
        <div class="abil">
          <div class="top"><strong>CHA</strong><span class="spacer"></span><label class="small-note"><input
                type="checkbox" id="saveChaProf"> Prof</label></div>
          <div class="bottom">
            <input id="chaInput" type="number" step="1" class="small">
            <span class="value-pill mod" id="chaModSpan">+0</span>
            <span class="value-pill save" id="saveChaTotalSpan">+0</span>
          </div>
        </div>
      </div>

      <div class="section-title">Skills</div>
      <table>
        <thead>
          <tr>
            <th>Skill</th>
            <th>Ability</th>
            <th>Prof</th>
            <th class="right">Bonus</th>
          </tr>
        </thead>
        <tbody id="skillsBody"></tbody>
      </table>

      <div class="section-title">Ð‘ÐµÐ»ÐµÐ¶ÐºÐ¸</div>
      <textarea id="notes" rows="4"
        style="width:100%;background:#101323;color:var(--text);border:1px solid var(--border);border-radius:10px;padding:8px"></textarea>
    </div>
    <div id="tab-pcchar" class="tab hidden"><!-- Loading... --></div>

    <!-- Inventory tab -->
    <div id="tab-inventory" class="tab hidden"><!-- Loading... --></div>
    <!-- Shenanigans tab -->
    <div id="tab-shenanigans" class="tab hidden"><!-- Loading... --></div>

    <!-- One-Liners tab -->
    <div id="tab-liners" class="tab hidden"><!-- Loading... --></div>

    <!-- Excuses tab -->
    <div id="tab-excuses" class="tab hidden"><!-- Loading... --></div>

    <!-- Familiar Names tab -->
    <div id="tab-familiars" class="tab hidden"><!-- Loading... --></div>

    <div id="tab-skills" class="tab hidden"><!-- Loading... --></div>

    <div id="tab-sessionNotes" class="tab hidden"><!-- Loading... --></div>
  </div>


  <!-- Module scripts (load before app.js) -->
  <script src="modules/aliases.js"></script>
  <script src="modules/familiars.js"></script>
  <script src="modules/one-liners.js"></script>
  <script src="modules/excuses.js"></script>
  <script src="modules/inventory.js"></script>
  <script src="modules/pcchar.js"></script>
  <script src="app.js"></script>
</body>

</html>
